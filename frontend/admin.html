<!doctype html>
<html lang="es">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TC2000 Fantasy</title>

  <!-- Page Icon -->
  <link rel="icon" href="resources\img\tcfantasy.ico">

  <!-- Font Racing -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

  <!-- Socket.IO client (global io) -->
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

  <link rel="stylesheet" href="resources\css\style.css">
</head>

<body>
  <div id="app" class="theme-light">
    <header class="site-header">
      <div class="header-inner">
        <div class="brand">
          <img src="resources\img\tcfantasy.ico" alt="logo" class="logo" />
          <div class="title-wrap">
            <h1 class="title">TC2000 <span class="subtitle">Fantasy</span></h1>
            <small class="tagline">Proyecto educativo — Inspirado en F1 Fantasy</small>
          </div>
        </div>

        <div class="header-actions">
          <button id="backBtn" class="btn small outline">Volver</button>
          <div id="userArea" class="user-area">
            <button id="avatarBtn" class="avatar-btn" aria-haspopup="true" aria-expanded="false">
              <img id="avatarImg" src="" alt="avatar" class="avatar-img hidden">
              <span id="userLabel">Ingresar</span>
            </button>
            <button id="logoutBtn" class="btn small secondary hidden">Cerrar sesión</button>
          </div>
        </div>
      </div>
    </header>

    <main id="content" class="main container" role="main">
      <section class="card">
        <h3>Panel de Administración</h3>

        <!-- Pestañas de navegación -->
        <div class="tabs">
          <button class="tab active" data-tab="teams">Equipos y Pilotos</button>
          <button class="tab" data-tab="users">Gestión de Usuarios</button>
          <button class="tab" data-tab="logs">Logs del Servidor</button>
        </div>

        <!-- Contenido de las pestañas -->
        <div id="teams" class="tab-content">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
            <div class="card small">
              <h4>Crear Piloto</h4>
              <form id="createPilotForm" class="form-inline">
                <input type="text" id="pilot_name" placeholder="Nombre del piloto" required>
                <select id="pilot_team" required>
                  <option value="">Seleccionar equipo...</option>
                </select>
                <input type="number" id="pilot_number" placeholder="N° auto">
                <button type="button" id="createPilotBtn" class="btn small">Agregar piloto</button>
              </form>
            </div>
            <div class="card small">
              <h4>Crear Equipo</h4>
              <form id="createTeamForm" class="form-inline">
                <input type="text" id="team_name" placeholder="Nombre del equipo">
                <input type="text" id="team_country" placeholder="País">
                <button type="button" id="createTeamBtn" class="btn small">Crear equipo</button>
              </form>
            </div>
          </div>

          <div style="margin-top:12px;">
            <h4>Equipos existentes</h4>
            <div id="teamsList" class="list"></div>
          </div>

          <div style="margin-top:12px;">
            <h4>Pilotos</h4>
            <div id="pilotsList" class="grid"></div>
          </div>
        </div> <!-- Cierre de la pestaña de equipos -->

        <!-- Pestaña de Gestión de Usuarios -->
        <div id="users" class="tab-content hidden">
          <div class="admin-section">
            <h4>Gestión de Usuarios</h4>

            <!-- Formulario de Usuario -->
            <div class="card">
              <h5 id="formTitle">Crear Nuevo Usuario</h5>
              <form id="userForm" class="form-stacked">
                <input type="hidden" id="user_id">

                <div class="form-group">
                  <label for="username">Nombre de Usuario</label>
                  <input type="text" id="username" name="username" required>
                </div>

                <div class="form-group">
                  <label for="email">Correo Electrónico</label>
                  <input type="email" id="email" name="email" required>
                </div>

                <div class="form-group">
                  <label for="password">Contraseña</label>
                  <input type="password" id="password" name="password" autocomplete="new-password">
                  <small>Dejar en blanco para no cambiar la contraseña</small>
                </div>

                <div class="form-group">
                  <label for="role">Rol</label>
                  <select id="role" name="role" required>
                    <option value="user">Usuario</option>
                    <option value="admin">Administrador</option>
                  </select>
                </div>

                <div class="form-group">
                  <label class="checkbox-container">
                    <input type="checkbox" id="is_active" name="is_active" checked>
                    <span class="checkmark"></span>
                    Usuario Activo
                  </label>
                </div>

                <div class="form-actions">
                  <button type="submit" id="saveUserBtn" class="btn primary">Guardar</button>
                  <button type="button" id="cancelEditBtn" class="btn secondary"
                    style="display: none;">Cancelar</button>
                </div>
              </form>
            </div>

            <!-- Lista de Usuarios -->
            <div class="card" style="margin-top: 20px;">
              <h5>Usuarios Registrados</h5>
              <div class="table-responsive">
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>Usuario</th>
                      <th>Email</th>
                      <th>Rol</th>
                      <th>Estado</th>
                      <th>Último Acceso</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody id="usersList">
                    <tr>
                      <td colspan="6" class="text-center">Cargando usuarios...</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div> <!-- Cierre de la pestaña de usuarios -->

        <!-- Pestaña de Logs -->
        <div id="logs" class="tab-content hidden">
          <div class="admin-section">
            <h4>Logs del Servidor en Tiempo Real</h4>
            
            <div class="card">
              <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                <button type="button" id="clearLogsBtn" class="btn small secondary">Limpiar Logs</button>
                <button type="button" id="pauseLogsBtn" class="btn small secondary">Pausar</button>
              </div>
              
              <div id="logsList" style="
                height: 500px;
                overflow-y: auto;
                background: #1e1e1e;
                color: #d4d4d4;
                font-family: 'Courier New', monospace;
                padding: 10px;
                border-radius: 4px;
                font-size: 12px;
              ">
                <div style="color: #888;">Esperando logs del servidor...</div>
              </div>
            </div>
          </div>
        </div> <!-- Cierre de la pestaña de logs -->
      </section>
    </main>

    <footer class="site-footer">
      <p> 2025 TC2000 Fantasy — Panel Admin</p>
    </footer>

    <div id="toasts" aria-live="polite" aria-atomic="true"></div>
  </div>

  <script type="module" src="components.js"></script>
  <script type="module" src="admin.js"></script>
</body>

</html>